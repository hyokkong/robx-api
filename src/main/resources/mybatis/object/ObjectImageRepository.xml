<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rbox.object.adapter.out.persistence.repository.ObjectImageRepository">
  <resultMap id="ObjectImageMap" type="com.rbox.object.adapter.out.persistence.repository.ObjectImageEntity">
    <id property="imgId" column="img_id" />
    <result property="objId" column="obj_id" />
    <result property="url" column="url" />
    <result property="ordNo" column="ord_no" />
  </resultMap>

  <insert id="save" parameterType="com.rbox.object.adapter.out.persistence.repository.ObjectImageEntity" useGeneratedKeys="true" keyProperty="imgId" keyColumn="img_id">
    INSERT INTO tb_obj_img (obj_id, url, ord_no)
    VALUES (#{objId}, #{url}, #{ordNo})
  </insert>

  <select id="findByObjectId" parameterType="long" resultMap="ObjectImageMap">
    SELECT img_id, obj_id, url, ord_no
    FROM tb_obj_img
    WHERE obj_id = #{objId}
    ORDER BY ord_no
  </select>

  <delete id="delete" parameterType="long">
    DELETE FROM tb_obj_img WHERE img_id = #{imgId}
  </delete>
</mapper>
